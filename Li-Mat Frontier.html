<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Li-Mat Frontier - ææ–™æŠ€æœ¯å‰æ²¿èµ„è®¯èšåˆ</title>

    <!-- Chart.js æ•°æ®å¯è§†åŒ–åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <style>
        :root {
            --color-light-gray: rgb(204, 204, 204);
            --color-deep-green: rgb(0, 45, 40);
            --color-warm-gold: rgb(206, 164, 114);
            --color-dark-gray: rgb(102, 102, 102);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
        }

        /* Hero åŒºåŸŸæ¸å˜èƒŒæ™¯ */
        .hero-gradient {
            background: linear-gradient(135deg, var(--color-deep-green) 0%, rgba(0, 45, 40, 0.85) 100%);
        }

        /* å¡ç‰‡æ ·å¼ */
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border-left: 4px solid var(--color-warm-gold);
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
        }

        /* æ–‡ç« å¡ç‰‡ */
        .article-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(204, 204, 204, 0.3);
            position: relative;
            overflow: hidden;
        }

        .article-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--color-deep-green), var(--color-warm-gold));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .article-card:hover::before {
            transform: scaleX(1);
        }

        .article-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 32px rgba(0, 0, 0, 0.12);
            border-color: var(--color-warm-gold);
        }

        /* åˆ†ç±»æŒ‰é’® */
        .category-btn {
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .category-btn:hover {
            transform: scale(1.05);
        }

        .category-btn.active {
            background: var(--color-deep-green);
            color: white;
            border-color: var(--color-warm-gold);
        }

        /* æ ‡ç­¾äº‘ */
        .tag-cloud {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag-item {
            padding: 6px 16px;
            background: linear-gradient(135deg, rgba(0, 45, 40, 0.05), rgba(206, 164, 114, 0.05));
            border-radius: 20px;
            font-size: 13px;
            color: var(--color-dark-gray);
            transition: all 0.2s ease;
            border: 1px solid rgba(206, 164, 114, 0.2);
        }

        .tag-item:hover {
            background: var(--color-warm-gold);
            color: white;
            transform: translateY(-2px);
        }

        /* åŠ è½½åŠ¨ç”» */
        .loader {
            border: 3px solid var(--color-light-gray);
            border-top: 3px solid var(--color-deep-green);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* åˆ†äº«æŒ‰é’® */
        .share-btn {
            background: rgba(206, 164, 114, 0.1);
            color: var(--color-warm-gold);
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 13px;
            transition: all 0.2s ease;
            border: 1px solid rgba(206, 164, 114, 0.3);
        }

        .share-btn:hover {
            background: var(--color-warm-gold);
            color: white;
        }

        /* å›¾æ ‡æ ·å¼ */
        .material-icons {
            vertical-align: middle;
        }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            position: relative;
            height: 300px;
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body>

    <!-- Hero Section -->
    <section class="hero-gradient text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-5xl font-bold mb-4">Li-Mat Frontier</h1>
                <p class="text-xl opacity-90 mb-2">ææ–™æŠ€æœ¯å‰æ²¿èµ„è®¯èšåˆ | ä»…ä¾›ä¸ªäººç ”ç©¶ã€å­¦ä¹ ä½¿ç”¨</p>
                <p class="text-xs opacity-75">æ¯æ—¥ 8:50 è‡ªåŠ¨ä¾æ®ç›¸å…³æ€§åŠæ—¶æ•ˆæ€§æ›´æ–° 50 ç¯‡èµ„è®¯</p>
                <div class="mt-6 inline-flex items-center px-4 py-2 bg-white bg-opacity-20 rounded-lg">
                    <span class="material-icons text-sm mr-2">schedule</span>
                    <span class="text-sm">æœ€åæ›´æ–°: <span id="lastUpdate">åŠ è½½ä¸­...</span></span>
                </div>
            </div>
        </div>
    </section>

    <!-- Stats Dashboard -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-8 relative z-10">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium" style="color: var(--color-dark-gray)">æ€»æ–‡ç« æ•°</p>
                        <p class="text-3xl font-bold mt-2" style="color: var(--color-deep-green)" id="totalCount">0</p>
                    </div>
                    <span class="material-icons text-4xl" style="color: var(--color-warm-gold)">article</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium" style="color: var(--color-dark-gray)">ææ–™åˆ›æ–°</p>
                        <p class="text-3xl font-bold mt-2" style="color: var(--color-deep-green)" id="innovationCount">0</p>
                    </div>
                    <span class="material-icons text-4xl" style="color: var(--color-warm-gold)">science</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium" style="color: var(--color-dark-gray)">æ±½è½¦é˜²è…</p>
                        <p class="text-3xl font-bold mt-2" style="color: var(--color-deep-green)" id="corrosionCount">0</p>
                    </div>
                    <span class="material-icons text-4xl" style="color: var(--color-warm-gold)">shield</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium" style="color: var(--color-dark-gray)">è½¦å†…å¥åº·</p>
                        <p class="text-3xl font-bold mt-2" style="color: var(--color-deep-green)" id="healthCount">0</p>
                    </div>
                    <span class="material-icons text-4xl" style="color: var(--color-warm-gold)">health_and_safety</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Charts Section -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-8">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- åˆ†ç±»åˆ†å¸ƒå›¾ -->
            <div class="chart-container" style="position: relative;">
                <h3 class="text-lg font-bold mb-4" style="color: var(--color-deep-green)">
                    <span class="material-icons text-sm mr-1">pie_chart</span>
                    åˆ†ç±»åˆ†å¸ƒ
                </h3>
                <div style="display: flex; align-items: flex-start; height: 240px; padding-top: 10px;">
                    <!-- å·¦ä¾§å›¾ä¾‹ -->
                    <div id="categoryLegend" style="width: 120px; display: flex; flex-direction: column; justify-content: center; gap: 8px;">
                        <!-- åŠ¨æ€ç”Ÿæˆå›¾ä¾‹ -->
                    </div>
                    <!-- å³ä¾§å›¾è¡¨ -->
                    <div style="flex: 1; height: 180px; margin-top: -10px;">
                        <canvas id="categoryChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- çƒ­é—¨æ ‡ç­¾äº‘ -->
            <div class="chart-container">
                <h3 class="text-lg font-bold mb-4" style="color: var(--color-deep-green)">
                    <span class="material-icons text-sm mr-1">local_offer</span>
                    çƒ­é—¨æ ‡ç­¾
                </h3>
                <div id="tagCloud" class="tag-cloud" style="height: 260px; overflow-y: auto; display: flex; flex-wrap: wrap; align-content: flex-start;">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>
    </section>

    <!-- åˆ†ç±»å¯¼èˆª -->
    <nav class="sticky top-0 z-40 bg-white shadow-sm mb-6">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex overflow-x-auto py-4 space-x-3" id="categoryNav">
                <!-- åŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
    </nav>

    <!-- æ–‡ç« åˆ—è¡¨ -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-16">
        <!-- åŠ è½½çŠ¶æ€ -->
        <div id="loadingState" class="flex flex-col items-center justify-center py-20">
            <div class="loader"></div>
            <p class="mt-6 font-medium" style="color: var(--color-dark-gray)">æ­£åœ¨åŠ è½½èµ„è®¯...</p>
        </div>

        <!-- æ–‡ç« åˆ—è¡¨ -->
        <div id="articleList" class="space-y-6 hidden">
            <!-- åŠ¨æ€ç”Ÿæˆ -->
        </div>

        <!-- ç©ºçŠ¶æ€ -->
        <div id="emptyState" class="text-center py-20 hidden">
            <span class="material-icons text-6xl" style="color: var(--color-light-gray)">article</span>
            <p class="mt-4 text-lg" style="color: var(--color-dark-gray)">æš‚æ— ç›¸å…³èµ„è®¯</p>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-sm font-medium" style="color: var(--color-dark-gray)">Li-Mat Frontier | ææ–™æŠ€æœ¯å‰æ²¿èµ„è®¯èšåˆ</p>
            <p class="text-xs mt-2" style="color: var(--color-light-gray)">æ•°æ®æ¥æºäºå„ç½‘ç«™å®˜æ–¹ RSS æº | ä»…ä¾›ä¸ªäººå­¦ä¹ ç ”ç©¶ä½¿ç”¨</p>
        </div>
    </footer>

    <script>
        // å…¨å±€å˜é‡
        let allArticles = [];
        let currentCategory = 'å…¨éƒ¨';
        let categories = [];
        let categoryChart;

        // åˆå§‹åŒ–
        async function init() {
            console.log('ğŸš€ åˆå§‹åŒ–ä¸­...');
            await loadData();
        }

        // åŠ è½½æ•°æ®
        async function loadData() {
            try {
                const timestamp = new Date().getTime();
                const response = await fetch(`data/news.json?t=${timestamp}`);

                if (!response.ok) throw new Error(`HTTP ${response.status}`);

                const data = await response.json();
                allArticles = data.articles || [];
                categories = data.categories || [];

                document.getElementById('lastUpdate').textContent = data.updateTime || 'æœªçŸ¥';

                updateStats();
                generateCharts();
                generateTagCloud();
                generateCategoryNav();
                renderArticles();
                hideLoading();

                console.log(`âœ… åŠ è½½æˆåŠŸ: ${allArticles.length} ç¯‡æ–‡ç« `);
            } catch (error) {
                console.error('âŒ åŠ è½½å¤±è´¥:', error);
                showError();
            }
        }

        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            document.getElementById('totalCount').textContent = allArticles.length;
            document.getElementById('innovationCount').textContent =
                allArticles.filter(a => a.category === 'ææ–™åˆ›æ–°').length;
            document.getElementById('corrosionCount').textContent =
                allArticles.filter(a => a.category === 'æ±½è½¦é˜²è…').length;
            document.getElementById('healthCount').textContent =
                allArticles.filter(a => a.category === 'è½¦å†…å¥åº·').length;
        }

        // ç”Ÿæˆå›¾è¡¨
        function generateCharts() {
            // åˆ†ç±»åˆ†å¸ƒé¥¼å›¾ - åªæ˜¾ç¤º3ä¸ªåˆ†ç±»
            const categoryCounts = {};
            categories.forEach(cat => {
                categoryCounts[cat] = allArticles.filter(a => a.category === cat).length;
            });

            const colors = [
                'rgba(0, 45, 40, 0.8)',      // æ·±ç»¿ - ææ–™åˆ›æ–°
                'rgba(206, 164, 114, 0.8)',  // æš–é‡‘ - æ±½è½¦é˜²è…
                'rgba(102, 102, 102, 0.8)'   // æ·±ç° - è½¦å†…å¥åº·
            ];

            // ç”Ÿæˆå·¦ä¾§è‡ªå®šä¹‰å›¾ä¾‹
            const legendContainer = document.getElementById('categoryLegend');
            legendContainer.innerHTML = '';
            categories.forEach((cat, index) => {
                const legendItem = document.createElement('div');
                legendItem.style.cssText = 'display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--color-dark-gray);';
                legendItem.innerHTML = `
                    <span style="width: 12px; height: 12px; background: ${colors[index]}; border-radius: 50%; display: inline-block;"></span>
                    <span>${cat}</span>
                `;
                legendContainer.appendChild(legendItem);
            });

            const ctx1 = document.getElementById('categoryChart');
            categoryChart = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: categories,
                    datasets: [{
                        data: Object.values(categoryCounts),
                        backgroundColor: colors,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false  // éšè—é»˜è®¤å›¾ä¾‹
                        }
                    }
                }
            });
        }

        // ç”Ÿæˆæ ‡ç­¾äº‘
        function generateTagCloud() {
            const keywords = [
                'carbon fiber', 'coating', 'composite', 'corrosion', 'polymer',
                'aluminum', 'steel', 'plastic', 'sustainability', 'recycling',
                'graphene', 'epoxy', 'automotive', 'lightweight', 'material'
            ];

            const tagCloud = document.getElementById('tagCloud');
            keywords.forEach(keyword => {
                const tag = document.createElement('span');
                tag.className = 'tag-item';
                tag.textContent = keyword;
                tagCloud.appendChild(tag);
            });
        }

        // ç”Ÿæˆåˆ†ç±»å¯¼èˆª
        function generateCategoryNav() {
            const nav = document.getElementById('categoryNav');
            const allCategories = ['å…¨éƒ¨', ...categories];

            allCategories.forEach(category => {
                const button = document.createElement('button');
                button.className = `category-btn px-6 py-2 rounded-lg text-sm font-medium whitespace-nowrap ${
                    category === currentCategory ? 'active' : ''
                }`;
                button.style.cssText = category === currentCategory
                    ? 'background: var(--color-deep-green); color: white; border-color: var(--color-warm-gold);'
                    : 'background: white; color: var(--color-dark-gray);';
                button.textContent = category;
                button.onclick = () => switchCategory(category);
                nav.appendChild(button);
            });
        }

        // åˆ‡æ¢åˆ†ç±»
        function switchCategory(category) {
            currentCategory = category;

            // æ›´æ–°æŒ‰é’®æ ·å¼
            const buttons = document.querySelectorAll('#categoryNav button');
            buttons.forEach(btn => {
                if (btn.textContent === category) {
                    btn.classList.add('active');
                    btn.style.cssText = 'background: var(--color-deep-green); color: white; border-color: var(--color-warm-gold);';
                } else {
                    btn.classList.remove('active');
                    btn.style.cssText = 'background: white; color: var(--color-dark-gray);';
                }
            });

            renderArticles();
        }

        // æ¸²æŸ“æ–‡ç« 
        function renderArticles() {
            const container = document.getElementById('articleList');
            const emptyState = document.getElementById('emptyState');
            container.innerHTML = '';

            let filtered = currentCategory === 'å…¨éƒ¨'
                ? allArticles
                : allArticles.filter(a => a.category === currentCategory);

            if (filtered.length === 0) {
                container.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            emptyState.classList.add('hidden');
            container.classList.remove('hidden');

            filtered.forEach(article => {
                const card = createArticleCard(article);
                container.appendChild(card);
            });
        }

        // åˆ›å»ºæ–‡ç« å¡ç‰‡
        function createArticleCard(article) {
            const card = document.createElement('div');
            card.className = 'article-card';

            const date = new Date(article.date);
            const dateStr = date.toLocaleDateString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });

            card.innerHTML = `
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center space-x-3">
                        <span class="material-icons text-sm" style="color: var(--color-warm-gold)">schedule</span>
                        <span class="text-sm" style="color: var(--color-dark-gray)">${dateStr}</span>
                        <span class="px-3 py-1 rounded-full text-xs font-medium"
                              style="background: rgba(206, 164, 114, 0.15); color: var(--color-deep-green)">
                            ${escapeHtml(article.category)}
                        </span>
                    </div>
                    <button class="share-btn" onclick="shareArticle('${escapeHtml(article.link)}', '${escapeHtml(article.title)}')">
                        <span class="material-icons text-sm">share</span>
                        åˆ†äº«
                    </button>
                </div>

                <h3 class="text-xl font-bold mb-3 cursor-pointer transition-colors hover:opacity-80"
                    style="color: var(--color-deep-green)"
                    onclick="window.open('${escapeHtml(article.link)}', '_blank')">
                    ${escapeHtml(article.title)}
                </h3>

                <p class="text-sm leading-relaxed mb-4" style="color: var(--color-dark-gray)">
                    ${escapeHtml(article.summary || article.description)}
                </p>

                <button onclick="window.open('${escapeHtml(article.link)}', '_blank')"
                        class="inline-flex items-center text-sm font-medium transition-colors"
                        style="color: var(--color-warm-gold)">
                    æŸ¥çœ‹åŸæ–‡
                    <span class="material-icons text-sm ml-1">arrow_forward</span>
                </button>
            `;

            return card;
        }

        // åˆ†äº«æ–‡ç« 
        function shareArticle(url, title) {
            if (navigator.share) {
                navigator.share({ title, url });
            } else {
                navigator.clipboard.writeText(url);
                alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }
        }

        // HTMLè½¬ä¹‰
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text || '';
            return div.innerHTML;
        }

        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading() {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('articleList').classList.remove('hidden');
        }

        // æ˜¾ç¤ºé”™è¯¯
        function showError() {
            const loadingState = document.getElementById('loadingState');
            loadingState.innerHTML = `
                <span class="material-icons text-6xl" style="color: var(--color-light-gray)">error_outline</span>
                <p class="mt-4 text-lg" style="color: var(--color-dark-gray)">åŠ è½½å¤±è´¥</p>
                <button onclick="location.reload()"
                        class="mt-4 px-6 py-2 rounded-lg text-white"
                        style="background: var(--color-deep-green)">
                    é‡æ–°åŠ è½½
                </button>
            `;
        }

        // é¡µé¢åŠ è½½
        window.addEventListener('DOMContentLoaded', init);
    </script>

</body>
</html>